if (isEditing() && isCancelingEdit()) {
  // Tested ðŸ—¸
  jata.setViewState();
} else if (isEditing()) {
  // Tested ðŸ—¸
  jata.setViewState();
  enableEditing();
} else {
  // Tested ðŸ—¸
  enableEditing();
}

function isEditing() {
  return Boolean(editTodoItemForm());
}

function isCancelingEdit() {
  return "<%= @editing_todo.id %>" === editTodoItemForm().closest('.todo-item').id;
}

function editTodoItemForm() {
  return document.querySelector('textarea[name="todo_item[content]"]');
}

// Tested ðŸ—¸
function enableEditing() {
  var todoItem = document.getElementById('<%= @editing_todo.id %>');
  var todoRowLeft = todoItem.querySelector('.todo-row-left');
  todoItem.querySelector('.todo-text').style.display = 'none';
  todoRowLeft.insertAdjacentHTML(
    'afterend',
    '<%= j render 'todo_items/edit_form', todo_item: @editing_todo %>'
  );
  var textarea = todoItem.querySelector('textarea[name="todo_item[content]"]');
  var todoContent = textarea.value;
  textarea.focus();
  textarea.value = '';
  textarea.value = todoContent;
}

